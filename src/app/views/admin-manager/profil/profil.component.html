<section  *ngIf="userInfo" >
    <div class="content container-fluid">
  
    <!-- Page Header -->
    <div class="page-header">
      <div class="content container-fluid">
  
        <!-- Page Header -->
        <div class="page-header">
          <div class="row align-items-center">
            <div class="col">
              <h3 class="page-title"  >Profil</h3>
              <ul class="breadcrumb">
                <li class="breadcrumb-item"><a routerLink=""  ><span >Home</span></a></li>
                <li class="breadcrumb-item active"  > <span >profil</span> </li>
              </ul>
            </div>
          </div>
            
          </div>
        </div></div>
       
  
      <div class="row" >
          <div class="col-lg-4">
            <div class="card mb-4">
              
              <div class="card-body text-center">
                <img  [src]="getImageUrl()" 
                alt="avatar"
                  class="rounded-circle img-fluid" style="width: 150px;"/>
                <h5 class="my-3">{{ userInfo.firstname }}</h5>
                <p class="text-muted mb-1"> {{ userInfo.titre }}</p>
                <p class="text-muted mb-4">{{ userInfo.email }}</p>
                <div class="d-flex justify-content-center mb-2">
  
                  <button class="btn btn-outline-primary mb-2 me-2" (click)="openLg(userInfo)">Update profil</button>
  
                  <button class="btn btn-outline-primary mb-2 me-2" (click)="openScrollableContent(longContent)">Change Password </button>
  
                </div>
              </div>
            </div>
        </div>
          <div class="col-lg-8">
            <div class="card mb-4">
              <div class="card-body">
                <div class="row">
                  <div class="col-sm-3">
                    <p class="mb-0">First Name:</p>
                  </div>
                  <div class="col-sm-9">
                    <p class="text-muted mb-0">{{ userInfo.firstname }} </p>
                  </div>
                </div>
                <hr>
  
                <div class="row">
                  <div class="col-sm-3">
                    <p class="mb-0">Last Name:</p>
                  </div>
                  <div class="col-sm-9">
                    <p class="text-muted mb-0">{{ userInfo.userLastName }}</p>
                  </div>
                </div>
                <hr>
                <div class="row">
                  <div class="col-sm-3">
                    <p class="mb-0">Title:</p>
                  </div>
                  <div class="col-sm-9">
                    <p class="text-muted mb-0">{{ userInfo.titre }}</p>
                  </div>
                </div>
                <hr>
  
                <div class="row">
                  <div class="col-sm-3">
                    <p class="mb-0">Email:</p>
                  </div>
                  <div class="col-sm-9">
                    <p class="text-muted mb-0"> {{ userInfo.email }}</p>
                  </div>
                </div>
                <hr>
                <div class="row">
                  <div class="col-sm-3">
                    <p class="mb-0">Phone number:</p>
                  </div>
                  <div class="col-sm-9">
                    <p class="text-muted mb-0">(216)  {{ userInfo.phoneNumber }}</p>
                  </div>
                </div>
                <hr>
                <div class="row">
                  <div class="col-sm-3">
                    <p class="mb-0">Roles:</p>
                  </div>
                  <div class="col-sm-9"  *ngFor="let role of userInfo.roles">
                    <p class="text-muted mb-0">{{role.roleName}}</p>
                  </div>
                </div>
               
              </div>
            </div>
            </div>
        </div>
      </div>
    </section> 
    
    
  
  
  
  
  
  
  
  
  
  
  
  
  <ng-template #longContent let-modal>
      <div class="modal-header">
          <h4 class="modal-title">Change password</h4>
          <button type="button" class="btn-close" aria-label="Close" (click)="modal.dismiss('Cross click')"></button>
      </div>
      <div class="modal-body">
  
  
      <form [formGroup]="passwordForm" (ngSubmit)="onSubmit()">
        <div  class="col-md-12">
    
         <label class="form-label">Ancien mot de passe:<span class="text-danger">*</span></label>
    
        <input type="password"class="form-control" formControlName="oldPassword">
        <div  class="col-md-12">
        </div>
        <label class="form-label">Nouveau mot de passe:<span class="text-danger">*</span></label>
        <input type="password"class="form-control" formControlName="newPassword">
        <div  class="col-md-12">
        </div>
        <label class="form-label">Confirmer le nouveau mot de passe:<span class="text-danger">*</span></label>
        <input type="password"class="form-control" formControlName="confirmPassword">
        </div>
        <button type="submit" class="btn btn-primary" [disabled]="passwordForm.invalid">Changer le mot de passe</button>
      </form>	
      </div>
      <div class="modal-footer">
          <button type="button" class="btn btn-light" (click)="modal.close('Close click')">Close</button>
      </div>
  </ng-template>
  
  
  
  
  
  <ng-template #content let-modal>
      <div class="modal-header">
          <h4 class="modal-title">Update profil</h4>
          <button type="button" class="btn-close" aria-label="Close" (click)="modal.dismiss('Cross click')"></button>
      </div>
      <div class="modal-body">
      
      <form class="row g-3" #userForm="ngForm">
        <input type="hidden" name="id" [(ngModel)]="selectedUser.id" required>
        <div class="col-md-5">
          <label class="form-label">first name<span class="text-danger">*</span></label>
          <input type="text" class="form-control" name="firstname" [(ngModel)]="selectedUser.firstname" required >
         
          <div *ngIf=" userForm.controls['firstname']?.errors?.['required'] ">
            <small
            *ngIf=" userForm.controls['firstname']?.errors?.['required'] "
  
              class="text-danger"> * is required</small>
          </div>
        </div>
       
        <div class="col-md-5">
          <label class="form-label">Last Name<span class="text-danger">*</span></label>
          <input type="text" class="form-control" name="userLastName" [(ngModel)]="selectedUser.userLastName" required>
          <div *ngIf=" userForm.controls['userLastName']?.errors?.['required'] ">
            <small
            *ngIf=" userForm.controls['userLastName']?.errors?.['required'] "
  
              class="text-danger"> * is required</small>
          </div>
        </div>
       
       <div class="mb-3">
    <label class="form-label">Email<span class="text-danger">*</span></label>
    <input type="text" class="form-control" name="email" [(ngModel)]="selectedUser.email" required pattern="[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,}$" >
    <div class="alert alert-danger" role="alert" *ngIf="userForm.submitted && userForm.controls['email']?.errors?.['required'] ">
      Email is required
    </div>
    <div *ngIf=" userForm.controls['email']?.errors?.['required'] ">
      <small
      *ngIf=" userForm.controls['email']?.errors?.['required'] "
  
        class="text-danger"> * is required</small>
    </div>
    <div *ngIf=" userForm.controls['userLastName']?.errors?.['pattern'] ">
      <small
      *ngIf=" userForm.controls['userLastName']?.errors?.['pattern'] "
  
        class="text-danger"> *     Invalid email format    </small>
    </div>
   
  </div>
  
        <div  class="col-md-5">
          <label class="form-label">titre<span class="text-danger">*</span></label>
          <input type="text" class="form-control" name="titre" [(ngModel)]="selectedUser.titre"required>
          <div *ngIf=" userForm.controls['titre']?.errors?.['required'] ">
            <small
            *ngIf=" userForm.controls['titre']?.errors?.['required'] "
        
              class="text-danger"> * is required</small>
          </div>
        </div>
        <div  class="col-md-5">
          <label class="form-label">phoneNumber<span class="text-danger">*</span></label>
          <input  class="form-control" name="phoneNumber"[(ngModel)]="selectedUser.phoneNumber"required [pattern]="'^[0-9]{8}$'">
          
          <div *ngIf=" userForm.controls['phoneNumber']?.errors?.['required'] ">
            <small
            *ngIf=" userForm.controls['phoneNumber']?.errors?.['required'] "
        
              class="text-danger"> * is required</small>
          </div>
          <div *ngIf=" userForm.controls['phoneNumber']?.errors?.['pattern'] ">
            <small
            *ngIf=" userForm.controls['phoneNumber']?.errors?.['pattern'] "
        
              class="text-danger"> *  The phone number must be 8 digits long</small>
          </div>
         
        </div>
        <div class="form-group">
          <label for="profilePicture">Profile Picture</label>
          <input type='file' name="profilePicture" class="form-control-file" id="profilePicture" (change)="onFileSelected($event)" >
        </div>
        
        <div  class="alert alert-danger" role="alert" *ngIf="errorMessage">{{ errorMessage }}</div>
  
        <button type="submit" class="btn btn-primary" [disabled]=" userForm.invalid" (click)="updateUser()">Update</button>
      </form>	</div>
      <div class="modal-footer">
          <button type="button" class="btn btn-light" (click)="modal.close('Close click')">Close</button>
      </div>
  </ng-template>
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  